(function(Z,T){if(typeof exports=="object"&&typeof module=="object")module.exports=T();else if(typeof define=="function"&&define.amd)define([],T);else{var C=T();for(var P in C)(typeof exports=="object"?exports:Z)[P]=C[P]}})(self,function(){return(()=>{"use strict";var it={};(()=>{it.r=r=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}})();var Z={};it.r(Z);const{abs:T,cos:C,sin:P,acos:Dt,atan2:F,sqrt:R,pow:q}=Math;function U(r){return r<0?-q(-r,1/3):q(r,1/3)}const pt=Math.PI,Q=2*pt,A=pt/2,Mt=1e-6,rt=Number.MAX_SAFE_INTEGER||9007199254740991,st=Number.MIN_SAFE_INTEGER||-9007199254740991,Ot={x:0,y:0,z:0},y={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(r,e){const i=e(r);let n=i.x*i.x+i.y*i.y;return typeof i.z!="undefined"&&(n+=i.z*i.z),R(n)},compute:function(r,e,i){if(r===0)return e[0].t=0,e[0];const n=e.length-1;if(r===1)return e[n].t=1,e[n];const s=1-r;let c=e;if(n===0)return e[0].t=r,e[0];if(n===1){const u={x:s*c[0].x+r*c[1].x,y:s*c[0].y+r*c[1].y,t:r};return i&&(u.z=s*c[0].z+r*c[1].z),u}if(n<4){let u=s*s,a=r*r,l,h,f,x=0;n===2?(c=[c[0],c[1],c[2],Ot],l=u,h=s*r*2,f=a):n===3&&(l=u*s,h=u*r*3,f=s*a*3,x=r*a);const p={x:l*c[0].x+h*c[1].x+f*c[2].x+x*c[3].x,y:l*c[0].y+h*c[1].y+f*c[2].y+x*c[3].y,t:r};return i&&(p.z=l*c[0].z+h*c[1].z+f*c[2].z+x*c[3].z),p}const o=JSON.parse(JSON.stringify(e));for(;o.length>1;){for(let u=0;u<o.length-1;u++)o[u]={x:o[u].x+(o[u+1].x-o[u].x)*r,y:o[u].y+(o[u+1].y-o[u].y)*r},typeof o[u].z!="undefined"&&(o[u]=o[u].z+(o[u+1].z-o[u].z)*r);o.splice(o.length-1,1)}return o[0].t=r,o[0]},computeWithRatios:function(r,e,i,n){const s=1-r,c=i,o=e;let u=c[0],a=c[1],l=c[2],h=c[3],f;if(u*=s,a*=r,o.length===2)return f=u+a,{x:(u*o[0].x+a*o[1].x)/f,y:(u*o[0].y+a*o[1].y)/f,z:n?(u*o[0].z+a*o[1].z)/f:!1,t:r};if(u*=s,a*=2*s,l*=r*r,o.length===3)return f=u+a+l,{x:(u*o[0].x+a*o[1].x+l*o[2].x)/f,y:(u*o[0].y+a*o[1].y+l*o[2].y)/f,z:n?(u*o[0].z+a*o[1].z+l*o[2].z)/f:!1,t:r};if(u*=s,a*=1.5*s,l*=3*s,h*=r*r*r,o.length===4)return f=u+a+l+h,{x:(u*o[0].x+a*o[1].x+l*o[2].x+h*o[3].x)/f,y:(u*o[0].y+a*o[1].y+l*o[2].y+h*o[3].y)/f,z:n?(u*o[0].z+a*o[1].z+l*o[2].z+h*o[3].z)/f:!1,t:r}},derive:function(r,e){const i=[];for(let n=r,s=n.length,c=s-1;s>1;s--,c--){const o=[];for(let u=0,a;u<c;u++)a={x:c*(n[u+1].x-n[u].x),y:c*(n[u+1].y-n[u].y)},e&&(a.z=c*(n[u+1].z-n[u].z)),o.push(a);i.push(o),n=o}return i},between:function(r,e,i){return e<=r&&r<=i||y.approximately(r,e)||y.approximately(r,i)},approximately:function(r,e,i){return T(r-e)<=(i||Mt)},length:function(r){const e=.5,i=y.Tvalues.length;let n=0;for(let s=0,c;s<i;s++)c=e*y.Tvalues[s]+e,n+=y.Cvalues[s]*y.arcfn(c,r);return e*n},map:function(r,e,i,n,s){const c=i-e,o=s-n,u=r-e,a=u/c;return n+o*a},lerp:function(r,e,i){const n={x:e.x+r*(i.x-e.x),y:e.y+r*(i.y-e.y)};return e.z!==void 0&&i.z!==void 0&&(n.z=e.z+r*(i.z-e.z)),n},pointToString:function(r){let e=r.x+"/"+r.y;return typeof r.z!="undefined"&&(e+="/"+r.z),e},pointsToString:function(r){return"["+r.map(y.pointToString).join(", ")+"]"},copy:function(r){return JSON.parse(JSON.stringify(r))},angle:function(r,e,i){const n=e.x-r.x,s=e.y-r.y,c=i.x-r.x,o=i.y-r.y,u=n*o-s*c,a=n*c+s*o;return F(u,a)},round:function(r,e){const i=""+r,n=i.indexOf(".");return parseFloat(i.substring(0,n+1+e))},dist:function(r,e){const i=r.x-e.x,n=r.y-e.y;return R(i*i+n*n)},closest:function(r,e){let i=q(2,63),n,s;return r.forEach(function(c,o){s=y.dist(e,c),s<i&&(i=s,n=o)}),{mdist:i,mpos:n}},abcratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r=="undefined")r=.5;else if(r===0||r===1)return r;const i=q(r,e)+q(1-r,e),n=i-1;return T(n/i)},projectionratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r=="undefined")r=.5;else if(r===0||r===1)return r;const i=q(1-r,e),n=q(r,e)+i;return i/n},lli8:function(r,e,i,n,s,c,o,u){const a=(r*n-e*i)*(s-o)-(r-i)*(s*u-c*o),l=(r*n-e*i)*(c-u)-(e-n)*(s*u-c*o),h=(r-i)*(c-u)-(e-n)*(s-o);return h==0?!1:{x:a/h,y:l/h}},lli4:function(r,e,i,n){const s=r.x,c=r.y,o=e.x,u=e.y,a=i.x,l=i.y,h=n.x,f=n.y;return y.lli8(s,c,o,u,a,l,h,f)},lli:function(r,e){return y.lli4(r,r.c,e,e.c)},makeline:function(r,e){const i=r.x,n=r.y,s=e.x,c=e.y,o=(s-i)/3,u=(c-n)/3;return new v(i,n,i+o,n+u,i+2*o,n+2*u,s,c)},findbbox:function(r){let e=rt,i=rt,n=st,s=st;return r.forEach(function(c){const o=c.bbox();e>o.x.min&&(e=o.x.min),i>o.y.min&&(i=o.y.min),n<o.x.max&&(n=o.x.max),s<o.y.max&&(s=o.y.max)}),{x:{min:e,mid:(e+n)/2,max:n,size:n-e},y:{min:i,mid:(i+s)/2,max:s,size:s-i}}},shapeintersections:function(r,e,i,n,s){if(!y.bboxoverlap(e,n))return[];const c=[],o=[r.startcap,r.forward,r.back,r.endcap],u=[i.startcap,i.forward,i.back,i.endcap];return o.forEach(function(a){a.virtual||u.forEach(function(l){if(l.virtual)return;const h=a.intersects(l,s);h.length>0&&(h.c1=a,h.c2=l,h.s1=r,h.s2=i,c.push(h))})}),c},makeshape:function(r,e,i){const n=e.points.length,s=r.points.length,c=y.makeline(e.points[n-1],r.points[0]),o=y.makeline(r.points[s-1],e.points[0]),u={startcap:c,forward:r,back:e,endcap:o,bbox:y.findbbox([c,r,e,o])};return u.intersections=function(a){return y.shapeintersections(u,u.bbox,a,a.bbox,i)},u},getminmax:function(r,e,i){if(!i)return{min:0,max:0};let n=rt,s=st,c,o;i.indexOf(0)===-1&&(i=[0].concat(i)),i.indexOf(1)===-1&&i.push(1);for(let u=0,a=i.length;u<a;u++)c=i[u],o=r.get(c),o[e]<n&&(n=o[e]),o[e]>s&&(s=o[e]);return{min:n,mid:(n+s)/2,max:s,size:s-n}},align:function(r,e){const i=e.p1.x,n=e.p1.y,s=-F(e.p2.y-n,e.p2.x-i),c=function(o){return{x:(o.x-i)*C(s)-(o.y-n)*P(s),y:(o.x-i)*P(s)+(o.y-n)*C(s)}};return r.map(c)},roots:function(r,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const i=r.length-1,n=y.align(r,e),s=function(m){return 0<=m&&m<=1};if(i===2){const m=n[0].y,_=n[1].y,M=n[2].y,O=m-2*_+M;if(O!==0){const $=-R(_*_-m*M),N=-m+_,V=-($+N)/O,j=-(-$+N)/O;return[V,j].filter(s)}else if(_!==M&&O===0)return[(2*_-M)/(2*_-2*M)].filter(s);return[]}const c=n[0].y,o=n[1].y,u=n[2].y,a=n[3].y;let l=-c+3*o-3*u+a,h=3*c-6*o+3*u,f=-3*c+3*o,x=c;if(y.approximately(l,0)){if(y.approximately(h,0))return y.approximately(f,0)?[]:[-x/f].filter(s);const m=R(f*f-4*h*x),_=2*h;return[(m-f)/_,(-f-m)/_].filter(s)}h/=l,f/=l,x/=l;const p=(3*f-h*h)/3,d=p/3,g=(2*h*h*h-9*h*f+27*x)/27,k=g/2,w=k*k+d*d*d;let E,b,D,S,z;if(w<0){const m=-p/3,_=m*m*m,M=R(_),O=-g/(2*M),$=O<-1?-1:O>1?1:O,N=Dt($),V=U(M),j=2*V;return D=j*C(N/3)-h/3,S=j*C((N+Q)/3)-h/3,z=j*C((N+2*Q)/3)-h/3,[D,S,z].filter(s)}else{if(w===0)return E=k<0?U(-k):-U(k),D=2*E-h/3,S=-E-h/3,[D,S].filter(s);{const m=R(w);return E=U(-k+m),b=U(k+m),[E-b-h/3].filter(s)}}},droots:function(r){if(r.length===3){const e=r[0],i=r[1],n=r[2],s=e-2*i+n;if(s!==0){const c=-R(i*i-e*n),o=-e+i,u=-(c+o)/s,a=-(-c+o)/s;return[u,a]}else if(i!==n&&s===0)return[(2*i-n)/(2*(i-n))];return[]}if(r.length===2){const e=r[0],i=r[1];return e!==i?[e/(e-i)]:[]}return[]},curvature:function(r,e,i,n,s){let c,o,u,a,l=0,h=0;const f=y.compute(r,e),x=y.compute(r,i),p=f.x*f.x+f.y*f.y;if(n?(c=R(q(f.y*x.z-x.y*f.z,2)+q(f.z*x.x-x.z*f.x,2)+q(f.x*x.y-x.x*f.y,2)),o=q(p+f.z*f.z,3/2)):(c=f.x*x.y-f.y*x.x,o=q(p,3/2)),c===0||o===0)return{k:0,r:0};if(l=c/o,h=o/c,!s){const d=y.curvature(r-.001,e,i,n,!0).k,g=y.curvature(r+.001,e,i,n,!0).k;a=(g-l+(l-d))/2,u=(T(g-l)+T(l-d))/2}return{k:l,r:h,dk:a,adk:u}},inflections:function(r){if(r.length<4)return[];const e=y.align(r,{p1:r[0],p2:r.slice(-1)[0]}),i=e[2].x*e[1].y,n=e[3].x*e[1].y,s=e[1].x*e[2].y,c=e[3].x*e[2].y,o=18*(-3*i+2*n+3*s-c),u=18*(3*i-n-3*s),a=18*(s-i);if(y.approximately(o,0)){if(!y.approximately(u,0)){let x=-a/u;if(0<=x&&x<=1)return[x]}return[]}const l=u*u-4*o*a,h=Math.sqrt(l),f=2*o;return y.approximately(f,0)?[]:[(h-u)/f,-(u+h)/f].filter(function(x){return 0<=x&&x<=1})},bboxoverlap:function(r,e){const i=["x","y"],n=i.length;for(let s=0,c,o,u,a;s<n;s++)if(c=i[s],o=r[c].mid,u=e[c].mid,a=(r[c].size+e[c].size)/2,T(o-u)>=a)return!1;return!0},expandbox:function(r,e){e.x.min<r.x.min&&(r.x.min=e.x.min),e.y.min<r.y.min&&(r.y.min=e.y.min),e.z&&e.z.min<r.z.min&&(r.z.min=e.z.min),e.x.max>r.x.max&&(r.x.max=e.x.max),e.y.max>r.y.max&&(r.y.max=e.y.max),e.z&&e.z.max>r.z.max&&(r.z.max=e.z.max),r.x.mid=(r.x.min+r.x.max)/2,r.y.mid=(r.y.min+r.y.max)/2,r.z&&(r.z.mid=(r.z.min+r.z.max)/2),r.x.size=r.x.max-r.x.min,r.y.size=r.y.max-r.y.min,r.z&&(r.z.size=r.z.max-r.z.min)},pairiteration:function(r,e,i){const n=r.bbox(),s=e.bbox(),c=1e5,o=i||.5;if(n.x.size+n.y.size<o&&s.x.size+s.y.size<o)return[(c*(r._t1+r._t2)/2|0)/c+"/"+(c*(e._t1+e._t2)/2|0)/c];let u=r.split(.5),a=e.split(.5),l=[{left:u.left,right:a.left},{left:u.left,right:a.right},{left:u.right,right:a.right},{left:u.right,right:a.left}];l=l.filter(function(f){return y.bboxoverlap(f.left.bbox(),f.right.bbox())});let h=[];return l.length===0||(l.forEach(function(f){h=h.concat(y.pairiteration(f.left,f.right,o))}),h=h.filter(function(f,x){return h.indexOf(f)===x})),h},getccenter:function(r,e,i){const n=e.x-r.x,s=e.y-r.y,c=i.x-e.x,o=i.y-e.y,u=n*C(A)-s*P(A),a=n*P(A)+s*C(A),l=c*C(A)-o*P(A),h=c*P(A)+o*C(A),f=(r.x+e.x)/2,x=(r.y+e.y)/2,p=(e.x+i.x)/2,d=(e.y+i.y)/2,g=f+u,k=x+a,w=p+l,E=d+h,b=y.lli8(f,x,g,k,p,d,w,E),D=y.dist(b,r);let S=F(r.y-b.y,r.x-b.x),z=F(e.y-b.y,e.x-b.x),m=F(i.y-b.y,i.x-b.x),_;return S<m?((S>z||z>m)&&(S+=Q),S>m&&(_=m,m=S,S=_)):m<z&&z<S?(_=m,m=S,S=_):m+=Q,b.s=S,b.e=m,b.r=D,b},numberSort:function(r,e){return r-e}};class H{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(e){return y.pointsToString(e.points)}).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map(function(e){return e.length()}).reduce(function(e,i){return e+i})}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var i=e[0].bbox(),n=1;n<e.length;n++)y.expandbox(i,e[n].bbox());return i}offset(e){const i=[];return this.curves.forEach(function(n){i.push(...n.offset(e))}),new H(i)}}const{abs:G,min:dt,max:mt,cos:Tt,sin:Pt,acos:Rt,sqrt:X}=Math,At=Math.PI,Zt={x:0,y:0,z:0};class v{constructor(e){let i=e&&e.forEach?e:Array.from(arguments).slice(),n=!1;if(typeof i[0]=="object"){n=i.length;const x=[];i.forEach(function(p){["x","y","z"].forEach(function(d){typeof p[d]!="undefined"&&x.push(p[d])})}),i=x}let s=!1;const c=i.length;if(n){if(n>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");s=!0}}else if(c!==6&&c!==8&&c!==9&&c!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const o=this._3d=!s&&(c===9||c===12)||e&&e[0]&&typeof e[0].z!="undefined",u=this.points=[];for(let x=0,p=o?3:2;x<c;x+=p){var a={x:i[x],y:i[x+1]};o&&(a.z=i[x+2]),u.push(a)}const l=this.order=u.length-1,h=this.dims=["x","y"];o&&h.push("z"),this.dimlen=h.length;const f=y.align(u,{p1:u[0],p2:u[l]});this._linear=!f.some(x=>G(x.y)>1e-4),this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,i,n,s){if(typeof s=="undefined"&&(s=.5),s===0)return new v(i,i,n);if(s===1)return new v(e,i,i);const c=v.getABC(2,e,i,n,s);return new v(e,c.A,n)}static cubicFromPoints(e,i,n,s,c){typeof s=="undefined"&&(s=.5);const o=v.getABC(3,e,i,n,s);typeof c=="undefined"&&(c=y.dist(i,o.C));const u=c*(1-s)/s,a=y.dist(e,n),l=(n.x-e.x)/a,h=(n.y-e.y)/a,f=c*l,x=c*h,p=u*l,d=u*h,g={x:i.x-f,y:i.y-x},k={x:i.x+p,y:i.y+d},w=o.A,E={x:w.x+(g.x-w.x)/(1-s),y:w.y+(g.y-w.y)/(1-s)},b={x:w.x+(k.x-w.x)/s,y:w.y+(k.y-w.y)/s},D={x:e.x+(E.x-e.x)/s,y:e.y+(E.y-e.y)/s},S={x:n.x+(b.x-n.x)/(1-s),y:n.y+(b.y-n.y)/(1-s)};return new v(e,D,S,n)}static getUtils(){return y}getUtils(){return v.getUtils()}static get PolyBezier(){return H}valueOf(){return this.toString()}toString(){return y.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,i=e[0].x,n=e[0].y,s=["M",i,n,this.order===2?"Q":"C"];for(let c=1,o=e.length;c<o;c++)s.push(e[c].x),s.push(e[c].y);return s.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map(function(e,i){return""+i+e.x+e.y+(e.z?e.z:0)}).join("")}update(){this._lut=[],this.dpoints=y.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,i=y.angle(e[0],e[this.order],e[1]);this.clockwise=i>0}length(){return y.length(this.derivative.bind(this))}static getABC(e=2,i,n,s,c=.5){const o=y.projectionratio(c,e),u=1-o,a={x:o*i.x+u*s.x,y:o*i.y+u*s.y},l=y.abcratio(c,e);return{A:{x:n.x+(n.x-a.x)/l,y:n.y+(n.y-a.y)/l},B:n,C:a,S:i,E:s}}getABC(e,i){i=i||this.get(e);let n=this.points[0],s=this.points[this.order];return v.getABC(this.order,n,i,s,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e)return this._lut;this._lut=[],e--;for(let i=0,n,s;i<e;i++)s=i/(e-1),n=this.compute(s),n.t=s,this._lut.push(n);return this._lut}on(e,i){i=i||5;const n=this.getLUT(),s=[];for(let c=0,o,u=0;c<n.length;c++)o=n[c],y.dist(o,e)<i&&(s.push(o),u+=c/n.length);return s.length?t/=s.length:!1}project(e){const i=this.getLUT(),n=i.length-1,s=y.closest(i,e),c=s.mpos,o=(c-1)/n,u=(c+1)/n,a=.1/n;let l=s.mdist,h=o,f=h,x;l+=1;for(let p;h<u+a;h+=a)x=this.compute(h),p=y.dist(e,x),p<l&&(l=p,f=h);return f=f<0?0:f>1?1:f,x=this.compute(f),x.t=f,x.d=l,x}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?y.computeWithRatios(e,this.points,this.ratios,this._3d):y.compute(e,this.points,this._3d,this.ratios)}raise(){const e=this.points,i=[e[0]],n=e.length;for(let s=1,c,o;s<n;s++)c=e[s],o=e[s-1],i[s]={x:(n-s)/n*c.x+s/n*o.x,y:(n-s)/n*c.y+s/n*o.y};return i[n]=e[n-1],new v(i)}derivative(e){return y.compute(e,this.dpoints[0],this._3d)}dderivative(e){return y.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new v(y.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return y.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return y.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const i=this.derivative(e),n=X(i.x*i.x+i.y*i.y);return{x:-i.y/n,y:i.x/n}}__normal3(e){const i=this.derivative(e),n=this.derivative(e+.01),s=X(i.x*i.x+i.y*i.y+i.z*i.z),c=X(n.x*n.x+n.y*n.y+n.z*n.z);i.x/=s,i.y/=s,i.z/=s,n.x/=c,n.y/=c,n.z/=c;const o={x:n.y*i.z-n.z*i.y,y:n.z*i.x-n.x*i.z,z:n.x*i.y-n.y*i.x},u=X(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=u,o.y/=u,o.z/=u;const a=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{x:a[0]*i.x+a[1]*i.y+a[2]*i.z,y:a[3]*i.x+a[4]*i.y+a[5]*i.z,z:a[6]*i.x+a[7]*i.y+a[8]*i.z}}hull(e){let i=this.points,n=[],s=[],c=0;for(s[c++]=i[0],s[c++]=i[1],s[c++]=i[2],this.order===3&&(s[c++]=i[3]);i.length>1;){n=[];for(let o=0,u,a=i.length-1;o<a;o++)u=y.lerp(e,i[o],i[o+1]),s[c++]=u,n.push(u);i=n}return s}split(e,i){if(e===0&&!!i)return this.split(i).left;if(i===1)return this.split(e).right;const n=this.hull(e),s={left:this.order===2?new v([n[0],n[3],n[5]]):new v([n[0],n[4],n[7],n[9]]),right:this.order===2?new v([n[5],n[4],n[2]]):new v([n[9],n[8],n[6],n[3]]),span:n};return s.left._t1=y.map(0,0,1,this._t1,this._t2),s.left._t2=y.map(e,0,1,this._t1,this._t2),s.right._t1=y.map(e,0,1,this._t1,this._t2),s.right._t2=y.map(1,0,1,this._t1,this._t2),i?(i=y.map(i,e,1,0,1),s.right.split(i).left):s}extrema(){const e={};let i=[];return this.dims.forEach(function(n){let s=function(o){return o[n]},c=this.dpoints[0].map(s);e[n]=y.droots(c),this.order===3&&(c=this.dpoints[1].map(s),e[n]=e[n].concat(y.droots(c))),e[n]=e[n].filter(function(o){return o>=0&&o<=1}),i=i.concat(e[n].sort(y.numberSort))}.bind(this)),e.values=i.sort(y.numberSort).filter(function(n,s){return i.indexOf(n)===s}),e}bbox(){const e=this.extrema(),i={};return this.dims.forEach(function(n){i[n]=y.getminmax(this,n,e[n])}.bind(this)),i}overlaps(e){const i=this.bbox(),n=e.bbox();return y.bboxoverlap(i,n)}offset(e,i){if(typeof i!="undefined"){const n=this.get(e),s=this.normal(e),c={c:n,n:s,x:n.x+s.x*i,y:n.y+s.y*i};return this._3d&&(c.z=n.z+s.z*i),c}if(this._linear){const n=this.normal(0),s=this.points.map(function(c){const o={x:c.x+e*n.x,y:c.y+e*n.y};return c.z&&n.z&&(o.z=c.z+e*n.z),o});return[new v(s)]}return this.reduce().map(function(n){return n._linear?n.offset(e)[0]:n.scale(e)})}simple(){if(this.order===3){const s=y.angle(this.points[0],this.points[3],this.points[1]),c=y.angle(this.points[0],this.points[3],this.points[2]);if(s>0&&c<0||s<0&&c>0)return!1}const e=this.normal(0),i=this.normal(1);let n=e.x*i.x+e.y*i.y;return this._3d&&(n+=e.z*i.z),G(Rt(n))<At/3}reduce(){let e,i=0,n=0,s=.01,c,o=[],u=[],a=this.extrema().values;for(a.indexOf(0)===-1&&(a=[0].concat(a)),a.indexOf(1)===-1&&a.push(1),i=a[0],e=1;e<a.length;e++)n=a[e],c=this.split(i,n),c._t1=i,c._t2=n,o.push(c),i=n;return o.forEach(function(l){for(i=0,n=0;n<=1;)for(n=i+s;n<=1+s;n+=s)if(c=l.split(i,n),!c.simple()){if(n-=s,G(i-n)<s)return[];c=l.split(i,n),c._t1=y.map(i,0,1,l._t1,l._t2),c._t2=y.map(n,0,1,l._t1,l._t2),u.push(c),i=n;break}i<1&&(c=l.split(i,1),c._t1=y.map(i,0,1,l._t1,l._t2),c._t2=l._t2,u.push(c))}),u}scale(e){const i=this.order;let n=!1;if(typeof e=="function"&&(n=e),n&&i===2)return this.raise().scale(n);const s=this.clockwise,c=n?n(0):e,o=n?n(1):e,u=[this.offset(0,10),this.offset(1,10)],a=this.points,l=[],h=y.lli4(u[0],u[0].c,u[1],u[1].c);if(!h)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(f){const x=l[f*i]=y.copy(a[f*i]);x.x+=(f?o:c)*u[f].n.x,x.y+=(f?o:c)*u[f].n.y}),n?([0,1].forEach(function(f){if(!(i===2&&!!f)){var x=a[f+1],p={x:x.x-h.x,y:x.y-h.y},d=n?n((f+1)/i):e;n&&!s&&(d=-d);var g=X(p.x*p.x+p.y*p.y);p.x/=g,p.y/=g,l[f+1]={x:x.x+d*p.x,y:x.y+d*p.y}}}),new v(l)):([0,1].forEach(f=>{if(i===2&&!!f)return;const x=l[f*i],p=this.derivative(f),d={x:x.x+p.x,y:x.y+p.y};l[f+1]=y.lli4(x,d,h,a[f+1])}),new v(l))}outline(e,i,n,s){i=typeof i=="undefined"?e:i;const c=this.reduce(),o=c.length,u=[];let a=[],l,h=0,f=this.length();const x=typeof n!="undefined"&&typeof s!="undefined";function p(z,m,_,M,O){return function($){const N=M/_,V=(M+O)/_,j=m-z;return y.map($,0,1,z+N*j,z+V*j)}}c.forEach(function(z){const m=z.length();x?(u.push(z.scale(p(e,n,f,h,m))),a.push(z.scale(p(-i,-s,f,h,m)))):(u.push(z.scale(e)),a.push(z.scale(-i))),h+=m}),a=a.map(function(z){return l=z.points,l[3]?z.points=[l[3],l[2],l[1],l[0]]:z.points=[l[2],l[1],l[0]],z}).reverse();const d=u[0].points[0],g=u[o-1].points[u[o-1].points.length-1],k=a[o-1].points[a[o-1].points.length-1],w=a[0].points[0],E=y.makeline(k,d),b=y.makeline(g,w),D=[E].concat(u).concat([b]).concat(a),S=D.length;return new H(D)}outlineshapes(e,i,n){i=i||e;const s=this.outline(e,i).curves,c=[];for(let o=1,u=s.length;o<u/2;o++){const a=y.makeshape(s[o],s[u-o],n);a.startcap.virtual=o>1,a.endcap.virtual=o<u/2-1,c.push(a)}return c}intersects(e,i){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof v&&(e=e.reduce()),this.curveintersects(this.reduce(),e,i)):this.selfintersects(i)}lineIntersects(e){const i=dt(e.p1.x,e.p2.x),n=dt(e.p1.y,e.p2.y),s=mt(e.p1.x,e.p2.x),c=mt(e.p1.y,e.p2.y);return y.roots(this.points,e).filter(o=>{var u=this.get(o);return y.between(u.x,i,s)&&y.between(u.y,n,c)})}selfintersects(e){const i=this.reduce(),n=i.length-2,s=[];for(let c=0,o,u,a;c<n;c++)u=i.slice(c,c+1),a=i.slice(c+2),o=this.curveintersects(u,a,e),s.push(...o);return s}curveintersects(e,i,n){const s=[];e.forEach(function(o){i.forEach(function(u){o.overlaps(u)&&s.push({left:o,right:u})})});let c=[];return s.forEach(function(o){const u=y.pairiteration(o.left,o.right,n);u.length>0&&(c=c.concat(u))}),c}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,i,n,s){const c=(s-n)/4,o=this.get(n+c),u=this.get(s-c),a=y.dist(e,i),l=y.dist(e,o),h=y.dist(e,u);return G(l-a)+G(h-a)}_iterate(e,i){let n=0,s=1,c;do{c=0,s=1;let o=this.get(n),u,a,l,h,f=!1,x=!1,p,d=s,g=1,k=0;do if(x=f,h=l,d=(n+s)/2,k++,u=this.get(d),a=this.get(s),l=y.getccenter(o,u,a),l.interval={start:n,end:s},f=this._error(l,o,n,s)<=e,p=x&&!f,p||(g=s),f){if(s>=1){if(l.interval.end=g=1,h=l,s>1){let E={x:l.x+l.r*Tt(l.e),y:l.y+l.r*Pt(l.e)};l.e+=y.angle({x:l.x,y:l.y},E,this.get(1))}break}s=s+(s-n)/2}else s=d;while(!p&&c++<100);if(c>=100)break;h=h||l,i.push(h),n=g}while(s<1);return i}}let gt=10,ot=0,zt=300,J=.3,ct=0,vt=255,wt=0,_t=0;const Lt=r=>{zt=r},Nt=r=>{gt=r},jt=r=>{ot=r},It=r=>{J=r},Wt=r=>{ct=r},$t=(r,e,i)=>{vt=r,wt=e,_t=i},Ft=r=>{const e=Date.now()-zt;let i;for(let s=0;s<r.length;s++)if(r[s].time>=e){i=s;break}const n=i===0?r:i===void 0?[]:r.slice(i);for(let s=n.length-1;s>0;s--){const c=n[s];c.x===n[s-1].x&&c.y===n[s-1].y&&n.splice(s,1)}for(let s=n.length-1;s>1;s--){const c=n[s];c.x===n[s-2].x&&c.y===n[s-2].y&&(n.splice(s-1,2),s--)}return n},kt=r=>{if(r.length<3)throw new Error("to calculate control points, the point counts should be larger than 3");const e=Array(r.length),i=r.length;let n=i-2;for(;n>0;n--){const s=r[n],c=r[n+1],o=r[n-1],u=o.x-c.x,a=o.y-c.y,l=ut(u,a),h=u/l,f=a/l,x=ut(s.x-c.x,s.y-c.y),p=ut(s.x-o.x,s.y-o.y),d=s.x-h*x*J,g=s.y-f*x*J,k=s.x+h*p*J,w=s.y+f*p*J;e[n]={cn:{x:d,y:g},cp:{x:k,y:w}},(isNaN(d)||isNaN(g)||isNaN(k)||isNaN(w))&&console.log("a")}return e[i-1]={cn:{x:r[i-1].x,y:r[i-1].y},cp:{x:(r[i-1].x+e[i-2].cp.x)/2,y:(r[i-1].y+e[i-2].cp.y)/2}},e[0]={cn:{x:(r[0].x+e[n+1].cn.x)/2,y:(r[0].y+e[n+1].cn.y)/2},cp:{x:r[0].x,y:r[0].y}},e},bt=(r,e)=>{const i=[];for(let n=1;n<r.length;n++){const s=r[n-1],c=r[n],{cn:o}=e[n-1],{cp:u}=e[n],a=new v(s.x,s.y,o.x,o.y,u.x,u.y,c.x,c.y);i.push(a)}return i},Ut=(r,e)=>{const i=[],n=1-ct,s=gt-ot;let c=0;for(let o=0;o<r.length;o++){const u=r[o];c+=u.length();const l=ct+c/e*n,h=ot+c/e*s;i.push({bezier:u,opacity:l,width:h})}return i},Gt=(r,e)=>{r.save(),r.lineCap="butt";for(let i=0;i<e.length;i++){r.beginPath();const{bezier:n,width:s,opacity:c}=e[i];r.lineWidth=s,r.strokeStyle=`rgba(${vt},${wt},${_t},${c})`,r.moveTo(n.points[0].x,n.points[0].y),r.bezierCurveTo(n.points[1].x,n.points[1].y,n.points[2].x,n.points[2].y,n.points[3].x,n.points[3].y),r.stroke(),r.closePath()}r.restore()},Xt=(r,e)=>{if(e.length<3)throw new Error("too less points");const i=kt(e),n=bt(e,i),s=n.reduce((h,f)=>h+f.length(),0),c=s/50,o=[];n.forEach((h,f)=>{const x=h.length(),p=Math.ceil(x/c)+2,d=h.getLUT(p);f<n.length-1&&d.pop(),o.push(...d)});const u=kt(o),a=bt(o,u),l=Ut(a,s);Gt(r,l)};function ut(r,e){return Math.sqrt(r*r+e*e)}let Y=[];const I=document.querySelector("#cvs"),K=I.getContext("2d"),at=document.querySelector("#rangeDelay"),lt=document.querySelector("#rangeMaxWidth"),ft=document.querySelector("#rangeMinWidth"),ht=document.querySelector("#rangeTension"),yt=document.querySelector("#rangeOpacity"),B=document.querySelector("#rangeColorRed"),tt=document.querySelector("#rangeColorGreen"),et=document.querySelector("#rangeColorBlue"),Jt=document.querySelector("#colorBox"),St=I.getBoundingClientRect(),nt=(r=>{const e=r.backingStorePixelRatio||r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/e})(K);let xt=!1;function Yt(){xt||Et()}function Et(){if(K.clearRect(0,0,I.width,I.height),Y=Ft(Y),Y.length<3){xt=!1;return}xt=!0,Xt(K,Y),requestAnimationFrame(Et)}function L(r){const e=r.target,i=W(e);try{const n=parseFloat(i);switch(e.id){case at.id:Lt(n*1e3);break;case lt.id:Nt(n);break;case ft.id:jt(n);break;case ht.id:It(n);break;case yt.id:Wt(n);break;case B.id:case tt.id:case et.id:Ct(),$t(parseInt(B.value,10),parseInt(tt.value,10),parseInt(et.value,10));break}}catch(n){console.error("set params error:",n)}}function Vt(r){const e=r.clientX-St.x,i=r.clientY-St.y;Y.push({x:e,y:i,time:Date.now()}),Yt()}function W(r){const e=r.value.toString(),i=`${r.id}Value`,n=document.querySelector(`#${i}`);return n&&(n.textContent=e),e}function Ct(){Jt.style.backgroundColor=`rgb(${B.value},${tt.value},${et.value})`}function qt(){const r=I.getBoundingClientRect();I.setAttribute("width",`${r.width*nt}px`),I.setAttribute("height",`${r.height*nt}px`),K.scale(nt,nt)}return function(){at.addEventListener("input",L),lt.addEventListener("input",L),ft.addEventListener("input",L),ht.addEventListener("input",L),yt.addEventListener("input",L),B.addEventListener("input",L),tt.addEventListener("input",L),et.addEventListener("input",L),document.addEventListener("mousemove",Vt),window.addEventListener("resize",qt),qt(),W(at),W(lt),W(ft),W(ht),W(yt),Ct()}(),Z})()});
